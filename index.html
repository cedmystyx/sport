<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Big Data Digital City</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
    }

    .binary {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      font-family: monospace;
      font-size: 12px;
      line-height: 1.2;
      color: #00ffcc;
      opacity: 0.08;
      pointer-events: none;
      white-space: pre;
      z-index: 5;
    }
  </style>
</head>
<body>

<!-- ✅ Audio immersif futuriste -->
<audio autoplay loop>
  <source src="https://cdn.pixabay.com/audio/2023/03/07/audio_eb50a9b332.mp3" type="audio/mpeg">
</audio>

<a-scene background="color: #000">

  <!-- Caméra avec angle de vue comme dans la vidéo -->
  <a-entity id="cameraRig" position="0 3 40" rotation="-5 0 0"
    animation="property: position; to: 0 3 -300; dur: 40000; easing: linear; loop: true">
    <a-entity camera look-controls="enabled: false"></a-entity>
  </a-entity>

  <!-- Lumières -->
  <a-entity light="type: ambient; color: #88ffff; intensity: 0.6"></a-entity>
  <a-entity light="type: directional; color: #00ffff; intensity: 0.8" position="0 10 10"></a-entity>

  <!-- Sol miroir -->
  <a-entity geometry="primitive: plane; width: 200; height: 1000"
            rotation="-90 0 0"
            material="color: #111; metalness: 1; roughness: 0.1; shader: standard"></a-entity>

  <!-- Bâtiments + texte binaire intégré -->
  <a-entity id="city" generate-city></a-entity>

  <script>
    AFRAME.registerComponent('generate-city', {
      init: function () {
        const container = this.el;
        const binaryChars = ['0', '1'];

        for (let i = 0; i < 400; i++) {
          const x = (Math.random() - 0.5) * 80;
          const z = -i * 4 - 10;
          const h = Math.random() * 10 + 3;

          const box = document.createElement('a-box');
          box.setAttribute('position', `${x} ${h/2} ${z}`);
          box.setAttribute('width', '2');
          box.setAttribute('depth', '2');
          box.setAttribute('height', h.toFixed(2));
          box.setAttribute('color', '#00ffff');
          box.setAttribute('opacity', '0.6');
          container.appendChild(box);

          // Code binaire animé attaché au bâtiment
          const text = document.createElement('a-entity');
          text.setAttribute('text', {
            value: Array.from({length: 10}, () => binaryChars[Math.floor(Math.random() * 2)]).join(''),
            color: '#00ffff',
            align: 'center',
            width: 4
          });
          text.setAttribute('position', `${x} ${h + 1} ${z}`);
          text.setAttribute('animation', {
            property: 'position',
            to: `${x} ${h + 5} ${z}`,
            dur: 3000,
            dir: 'alternate',
            loop: true
          });
          container.appendChild(text);
        }
      }
    });
  </script>

</a-scene>

</body>
</html>
