<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Data City Matrix - Reproduction Vidéo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  <style>
    html, body {
      margin: 0; height: 100%; overflow: hidden;
      background: black;
      font-family: monospace;
      color: #0f0;
    }
  </style>
</head>
<body>

<a-scene
  background="color: #000"
  fog="type: linear; color: #002200; near: 1; far: 60"
  embedded
  vr-mode-ui="enabled: false">

  <!-- Caméra en vol continu -->
  <a-entity id="cameraRig" position="0 1.6 0"
    animation="property: position; to: 0 1.6 -150; dur: 90000; easing: linear; loop: true">
    <a-entity camera look-controls wasd-controls></a-entity>
  </a-entity>

  <!-- Conteneur bâtiments -->
  <a-entity id="city"></a-entity>

  <!-- Conteneur pluie de chiffres -->
  <a-entity id="rain"></a-entity>

</a-scene>

<script>
  const city = document.getElementById('city');
  const rain = document.getElementById('rain');

  // Génère une grille dense de bâtiments wireframe avec effet de glow simulé
  const buildingCount = 400;
  for(let i=0; i<buildingCount; i++){
    const building = document.createElement('a-box');

    // Hauteur aléatoire, entre 4 et 20
    const height = 4 + Math.random()*16;

    // Taille fixe petits cubes
    building.setAttribute('width', 1.5);
    building.setAttribute('depth', 1.5);
    building.setAttribute('height', height);

    // Position en grille 3D
    const x = (i % 20) - 10; // -10 à +9
    const z = -Math.floor(i / 20) * 3; // 20 lignes
    const y = height / 2;

    building.setAttribute('position', `${x} ${y} ${z}`);

    // Wireframe vert avec glow (simulate glow via opacity + emissive)
    building.setAttribute('material', 'wireframe:true; color:#00ff00; opacity:0.15; emissive:#00ff00; emissiveIntensity:0.8;');

    city.appendChild(building);
  }

  // Pluie de 0/1 en plusieurs couches pour effet profondeur
  const rainCount = 500;
  for(let i=0; i<rainCount; i++){
    const digit = document.createElement('a-text');

    // Valeur 0 ou 1
    digit.setAttribute('value', Math.random() > 0.5 ? '0' : '1');

    // Couleur néon verte
    digit.setAttribute('color', '#00ff00');

    // Opacité variable pour effet de profondeur
    digit.setAttribute('opacity', 0.3 + Math.random()*0.4);

    // Taille variable (petits chiffres)
    const scale = 0.3 + Math.random()*0.3;
    digit.setAttribute('scale', `${scale} ${scale} ${scale}`);

    // Position initiale aléatoire sur X, Y, Z
    const x = (Math.random() - 0.5) * 20; // +/- 10
    const y = Math.random() * 15 + 10; // assez haut
    const z = -Math.random() * 150; // profondeur jusqu'à -150
    digit.setAttribute('position', `${x} ${y} ${z}`);

    // Animation verticale "pluie" continue vers bas, boucle infinie
    // On anime la position Y de y à -10, et on décale en Z un peu pour effet de chute diagonal
    digit.setAttribute('animation', `
      property: position;
      from: ${x} ${y} ${z};
      to: ${x} -10 ${z - 10};
      dur: ${3000 + Math.random() * 4000};
      easing: linear;
      loop: true;
    `);

    rain.appendChild(digit);
  }
</script>

</body>
</html>
