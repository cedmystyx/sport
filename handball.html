<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Handball VR - Terrain Mondial Réaliste</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <!-- Version physics-system compatible avec A-Frame 1.5.0 -->
  <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@5.0.0/dist/aframe-physics-system.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/super-hands@4.0.3/dist/super-hands.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-extras@7.0.0/dist/aframe-extras.controls.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-animation-component@6.0.0/dist/aframe-animation-component.min.js"></script>
  <style>
    body {margin:0;}
    .score-ui {position: absolute; top:24px; right:24px; background:#fff9; color:#0a3a74; font-family:'Segoe UI',Arial,sans-serif; font-size:1.2em; border-radius:10px; box-shadow:0 2px 10px #0002; padding:0.7em 1.6em; z-index:10002; pointer-events:none; user-select:none; text-align:right;}
    .timer-ui {position:absolute;top:24px;left:24px;z-index:10001;font-family:'Segoe UI',Arial,sans-serif;background:#fff8;border-radius:13px;box-shadow:0 2px 16px #00335511;padding:.6em 1.6em;color:#184e77;font-size:1.3em;pointer-events:none;user-select:none;}
    .msg-ui {position:absolute;left:0;right:0;top:85px;text-align:center;z-index:10010;font-family:Impact,Arial,sans-serif;font-size:2em;letter-spacing:0.05em;color:#e63946;text-shadow:0 2px 20px #fff,0 0 30px #e63946aa;}
    .help-ui {position:absolute;left:24px;bottom:24px;z-index:10001;font-family:'Segoe UI',Arial,sans-serif;background:#fff8;border-radius:13px;box-shadow:0 2px 16px #00335511;padding:1em 2em;color:#184e77;font-size:1.09em;pointer-events:none;user-select:none;line-height:1.42em;}
  </style>
</head>
<body>
<a-scene physics="gravity:-9.8;" background="color: #e5f6ff" loading-screen="enabled:false">
  <a-assets>
    <img id="parquet" src="https://cdn.aframe.io/a-painter/images/floor.jpg">
    <img id="filet" src="https://cdn.pixabay.com/photo/2017/09/06/19/54/net-2726429_1280.png">
    <img id="tribune" src="https://cdn.pixabay.com/photo/2016/11/29/04/17/audience-1866738_1280.jpg">
    <img id="sky" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg">
    <img id="balltex" src="https://cdn.pixabay.com/photo/2017/01/30/22/50/handball-2023531_1280.jpg">
    <audio id="applaud" src="https://cdn.pixabay.com/audio/2022/03/15/audio_115b0e6db1.mp3" preload="auto"></audio>
    <!-- OBJ décor -->
    <a-asset-item id="fond-obj" src="resources/objects/fond.obj"></a-asset-item>
  </a-assets>

  <!-- OBJ décor -->
  <a-entity obj-model="obj: resources/objects/fond.obj"
            position="-34.47695 113.66056 449.313"
            scale="10 10 10"
            material="color: #3d3d3d"
            shadow=""
            rotation="90 0 0">
  </a-entity>

  <!-- Sol parquet -->
  <a-box position="0 0 0" width="14" height="0.12" depth="28" src="#parquet" color="#efd6a2" static-body></a-box>

  <!-- Lignes fixes -->
  <a-box position="0 0.071 0" width="14.0" height="0.018" depth="0.18" color="#fff"></a-box>
  <a-box position="0 0.071 14" width="14.0" height="0.02" depth="0.18" color="#fff"></a-box>
  <a-box position="0 0.071 -14" width="14.0" height="0.02" depth="0.18" color="#fff"></a-box>
  <a-box position="7 0.071 0" width="0.18" height="0.018" depth="28" color="#fff"></a-box>
  <a-box position="-7 0.071 0" width="0.18" height="0.018" depth="28" color="#fff"></a-box>
  <a-box position="0 0.072 0" width="14" height="0.018" depth="0.12" color="#fff"></a-box>
  <a-circle position="0 0.073 0" rotation="-90 0 0" radius="0.18" color="#1976d2"></a-circle>
  <a-ring position="0 0.079 11.2" rotation="-90 0 0" radius-inner="2.09" radius-outer="2.16" theta-start="270" theta-length="180" color="#fae600"></a-ring>
  <a-box position="2.09 0.079 12.25" width="0.13" height="0.012" depth="2.1" color="#fae600"></a-box>
  <a-box position="-2.09 0.079 12.25" width="0.13" height="0.012" depth="2.1" color="#fae600"></a-box>
  <a-box position="0 0.079 13.3" width="4.18" height="0.012" depth="0.13" color="#fae600"></a-box>
  <a-ring position="0 0.079 -11.2" rotation="-90 0 0" radius-inner="2.09" radius-outer="2.16" theta-start="90" theta-length="180" color="#fae600"></a-ring>
  <a-box position="2.09 0.079 -12.25" width="0.13" height="0.012" depth="2.1" color="#fae600"></a-box>
  <a-box position="-2.09 0.079 -12.25" width="0.13" height="0.012" depth="2.1" color="#fae600"></a-box>
  <a-box position="0 0.079 -13.3" width="4.18" height="0.012" depth="0.13" color="#fae600"></a-box>
  <a-box position="0 0.081 9.2" width="1.2" height="0.013" depth="0.09" color="#c0392b"></a-box>
  <a-box position="0 0.081 -9.2" width="1.2" height="0.013" depth="0.09" color="#c0392b"></a-box>
  <a-circle position="0 0.083 8.95" rotation="-90 0 0" radius="0.08" color="#c0392b"></a-circle>
  <a-circle position="0 0.083 -8.95" rotation="-90 0 0" radius="0.08" color="#c0392b"></a-circle>
  <a-ring position="0 0.081 11.2" rotation="-90 0 0" radius-inner="3.0" radius-outer="3.07" color="#ff9800" theta-length="180" theta-start="270" segments-theta="36"></a-ring>
  <a-ring position="0 0.081 -11.2" rotation="-90 0 0" radius-inner="3.0" radius-outer="3.07" color="#ff9800" theta-length="180" theta-start="90" segments-theta="36"></a-ring>
  <a-box position="0 0.062 13.5" width="3" height="0.01" depth="0.7" color="#d2e6fa" opacity="0.45"></a-box>
  <a-box position="0 0.062 -13.5" width="3" height="0.01" depth="0.7" color="#d2e6fa" opacity="0.45"></a-box>
  <a-box position="5.6 0.062 0" width="2.8" height="0.01" depth="6.6" color="#e1e2e2" opacity="0.27"></a-box>
  <a-box position="-5.6 0.062 0" width="2.8" height="0.01" depth="6.6" color="#e1e2e2" opacity="0.27"></a-box>

  <!-- Buts + filets animés -->
  <a-box position="0 1 13.7" width="3" height="2" depth="0.18" color="#f44336" static-body></a-box>
  <a-box position="-1.5 1 13.7" width="0.13" height="2" depth="0.22" color="#f44336" static-body></a-box>
  <a-box position="1.5 1 13.7" width="0.13" height="2" depth="0.22" color="#f44336" static-body></a-box>
  <a-box position="0 2 13.7" width="3" height="0.09" depth="0.22" color="#f44336" static-body></a-box>
  <a-plane position="0 1.01 13.8" width="2.7" height="1.82" src="#filet"
    animation="property: rotation.z; dir: alternate; from: 0; to: 2; dur: 1100; loop: true; easing: easeInOutSine"></a-plane>
  <a-box id="goal-trigger-north" position="0 1 13.81" width="2.6" height="1.75" depth="0.1" opacity="0" visible="false" static-body></a-box>
  <a-box position="0 1 -13.7" width="3" height="2" depth="0.18" color="#f44336" opacity="0.25" static-body></a-box>
  <a-plane position="0 1.01 -13.8" width="2.7" height="1.82" src="#filet"
    animation="property: rotation.z; dir: alternate; from: 0; to: -2; dur: 1100; loop: true; easing: easeInOutSine"></a-plane>
  <a-box id="goal-trigger-south" position="0 1 -13.81" width="2.6" height="1.75" depth="0.1" opacity="0" visible="false" static-body></a-box>

  <!-- Tribunes animées -->
  <a-plane position="0 2.7 15.4" width="14" height="5" src="#tribune"
    animation="property: position.x; dir: alternate; from: -0.1; to: 0.1; loop: true; dur: 3000"></a-plane>
  <a-plane position="0 2.7 -15.4" width="14" height="5" src="#tribune"
    animation="property: position.x; dir: alternate; from: 0.1; to: -0.1; loop: true; dur: 3100"></a-plane>
  <a-plane position="7.3 2.7 0" width="5" height="5" src="#tribune"
    animation="property: position.z; dir: alternate; from: 0.05; to: -0.05; loop: true; dur: 2700"></a-plane>
  <a-plane position="-7.3 2.7 0" width="5" height="5" src="#tribune"
    animation="property: position.z; dir: alternate; from: -0.05; to: 0.05; loop: true; dur: 2750"></a-plane>

  <!-- Skybox statique -->
  <a-sky src="#sky"></a-sky>

  <!-- Scoreboard -->
  <a-box position="0 3.11 11.2" width="2.8" height="0.7" depth="0.15" color="#fff8"
    animation="property: scale; dir: alternate; from: 1 1 1; to: 1.03 1.07 1; dur: 2000; loop: true"></a-box>
  <a-entity id="scoreboard" position="0 3.18 11.2" text="value: 0 - 0; color: #1e90ff; width: 4.5; align: center; font: https://cdn.aframe.io/fonts/Exo2Bold.fnt"></a-entity>

  <!-- Ballon jouable -->
  <a-sphere id="handball" class="grabbable dynamic-body" position="0 1.2 0" radius="0.23" src="#balltex"
    roughness="0.34" metalness="0.12"
    dynamic-body="mass: 0.36; linearDamping:0.07; angularDamping:0.13; restitution:0.81; friction:0.33"
    super-hands
    shadow></a-sphere>

  <!-- Joueur (caméra + mains VR/PC) -->
  <a-entity id="rig" movement-controls kinematic-body position="0 1.6 -7">
    <a-entity id="camera" camera look-controls wasd-controls="acceleration:20" position="0 0 0"></a-entity>
    <a-entity id="leftHand"
              hand-controls="hand: left; handModelStyle: highPoly; color: #e5b285"
              super-hands
              sphere-collider="objects: .grabbable"
              shadow></a-entity>
    <a-entity id="rightHand"
              hand-controls="hand: right; handModelStyle: highPoly; color: #d7a878"
              super-hands
              sphere-collider="objects: .grabbable"
              shadow></a-entity>
  </a-entity>

  <!-- Gardien et bot (exemples) -->
  <a-cylinder id="gardien" position="0 1 13.3" radius="0.32" height="1.8" color="#eaf05a" segments-radial="6"></a-cylinder>
  <a-sphere position="0 1.82 13.3" radius="0.19" color="#bab600"></a-sphere>
  <a-cylinder id="bot" position="0 1 7" radius="0.37" height="2" color="#aad4f7" segments-radial="6"></a-cylinder>
  <a-sphere position="0 2.24 7.47" radius="0.27" color="#0a3a74"></a-sphere>

  <!-- Score affiché en 2D -->
  <div class="score-ui" id="score-ui">0 - 0</div>
  <div class="help-ui">Déplace-toi avec ZQSD (ou joysticks VR), attrape le ballon avec les mains (VR/PC), jette-le dans le but ! Score s'affiche en haut à droite.</div>

  <!-- Lumières dynamiques réalistes -->
  <a-light type="ambient" color="#fff" intensity="1.0"></a-light>
  <a-light type="directional" color="#fffbe8" intensity="0.7" position="0 8 9"
    animation="property: position.x; from: -2; to: 2; dir: alternate; dur: 3500; loop: true"></a-light>
  <a-light type="spot" color="#fff4d1" intensity="0.6" position="0 7 0"
    animation="property: angle; dir: alternate; from: 18; to: 22; dur: 2100; loop: true"></a-light>

  <!-- Ambiance sonore -->
  <audio id="ambiance-audio" src="https://cdn.pixabay.com/audio/2022/11/16/audio_12e9c1f3c3.mp3" autoplay loop></audio>
</a-scene>
</body>
</html>
